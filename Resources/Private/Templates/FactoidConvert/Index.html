{namespace e=Org\Gucken\Events\ViewHelpers}
<?xml version="1.0" encoding="UTF-8"?>
<f:layout name="Page.html" />


<f:section name="content">
	
    <h2>Faktoide</h2>
	<div class="events-and-factoids clearfix">
		<div class="events">
			<f:for each="{events}" as="event">
				<f:cycle values="{0:'odd', 1: ''}" as="zebraClass">
					<div class="item event {zebraClass}">
						<div class="head">
							<span class="startdatetime">{event.startDateTime -> f:format.date(format:'d.m. H:i')}</span>
							<f:link.action class="title" action="show" controller="standard" title="{event.title}">{event.title -> f:format.crop(maxCharacters:40,append:'…')}</f:link.action>							
							<span class="location">{event.location.name}</span>
						</div>
						<f:if condition="1 == 0">
							<f:for each="{event.factoidIdentitys}" as="identity">						
								<div class="item identity">
									<div class="head">
										<span class="startdatetime">{identity.startDateTime -> f:format.date(format:'d.m. H:i')}</span>
										<span class="location">{identity.location.name}</span>
										<span class="source">{identity.source.name}</span>
									</div>
									<f:for each="{identity.factoids}" as="factoid">						
										<div class="factoid">
											<f:link.external class="title" uri="{factoid.url}" title="{factoid.title}">{factoid.title -> f:format.crop(maxCharacters:40,append:'…')}</f:link.external>
											<span class="type">{factoid.type.title}</span>
											<span class="importdatetime">{factoid.importDateTime -> f:format.date(format:'d.m. H:i')}</span>							
										</div>
									</f:for>
								</div>
							</f:for>
						</f:if>
					</div>
				</f:cycle>
			</f:for>
		</div>
		<div class="factoids">		
			<f:for each="{identities}" as="identity">
				<f:cycle values="{0:'odd', 1: ''}" as="zebraClass">
					<div class="item identity {zebraClass}">
						<div class="head">
							<input type="checkbox"  name="arguments[][__identity]" id="action_{e:identifier(object:identity)}" value="{e:identifier(object:identity)}" />							
							<f:link.action class="button trash" controller="factoidConvert" action="delete" arguments="{identity:identity}">delete</f:link.action>
							<f:link.action class="button convert" controller="factoidConvert" action="convert" arguments="{identity:identity}">convert</f:link.action>
							
							<span class="startdatetime">{identity.startDateTime -> f:format.date(format:'d.m. H:i')}</span>
							<span class="location">
								<f:if condition="{identity.location}">
									<f:then>{identity.location.name}</f:then>
									<f:else>
										<f:if condition="{identity.source.canConvertLocation}">
											<f:link.action controller="location" action="addFromSource" arguments="{source:identity.source,factoid:identity.factoids.0}" style="float:right;">&lt;--&nbsp;</f:link.action>
										</f:if>
									</f:else>
								</f:if>
							</span>
							<span class="source">{identity.source.name}</span>
						</div>
						<f:for each="{identity.factoids}" as="factoid">						
							<div class="factoid">
								<f:link.action class="button trash" controller="factoidConvert" action="deleteFactoid" arguments="{identity:identity,factoid:factoid}">delete</f:link.action>
								<f:link.action class="button details" controller="factoid" action="detail" arguments="{factoid:factoid}" title="{factoid.title}">details</f:link.action>
								<f:link.external class="title" uri="{factoid.url}" title="{factoid.title}">{factoid.title -> f:format.crop(maxCharacters:40,append:'…')}</f:link.external>
								<span class="type">{factoid.type.title}</span>
								<span class="importdatetime">{factoid.importDateTime -> f:format.date(format:'d.m. H:i')}</span>							
							</div>
						</f:for>
					</div>
				</f:cycle>
			</f:for>
		</div>		
	</div>
</f:section>

<f:section name="right">---</f:section>
